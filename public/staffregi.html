<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Staff Registration </title>
  <meta content="" name="description">
  <meta content="" name="keywords">


  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">


  <!-- External Libraries -->
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-database.js"></script>
  <script src="firefunctions.js"></script>
<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&family=Roboto:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Work+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">

<!-- Vendor CSS Files -->
<link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
<link href="assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet">
<link href="assets/vendor/aos/aos.css" rel="stylesheet">
<link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
<link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

<!-- Template Main CSS File -->
<link href="assets/css/main.css" rel="stylesheet">


<!-- Latest compiled and minified JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>




<style>
  * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
  body {
      font-family: 'Open Sans', sans-serif;
      line-height: 1.6;
      color: #333;
      
    }
    

  h2{
  margin-top:20px;
  margin-bottom:25px;
  text-align:center;
  }
  .footer{
  margin-top:20px;
  }
 
  .btn{
  margin-left:18%;
  }
  
  .gif{
position: fixed;
display: block;
width: 100%;
height: 100%;
top: 0;
left: 0;
right: 0;
bottom: 0;
background-color: rgba(0,0,0,0.5);
overflow: hidden;
z-index: 2;
cursor: progress;


}
.main-content {
      flex: 2;
      padding: 6rem 0;
    }

    .container {
      max-width: 1024px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    .form-card {
      background: gray;
      border-radius: 1rem;
      box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
      padding: 5rem;
    }

    .form-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .form-header h2 {
      font-size: 1.875rem;
      font-weight: bold;
      color: #1f2937;
      margin-bottom: 0.5rem;
    }

    .form-header p {
      color: #6b7280;
    }

.submit-section {
      display: flex;
  justify-content: center;
  padding-top: 1.5rem;
    }
.btn {
  background: gray;
  color: white;
  padding: 0.75rem 3rem;
  font-size: 1.5rem;
  font-weight: 600;
  border: none;
  border-radius: 0.5rem;
  cursor: pointer;
  transition: all 0.2s;
  box-shadow: 0 10px 15px -3px rgba(187, 173, 173, 0.1);
  
  margin: 0 auto; 
}
    .btn:hover {
      background: darkgray;
      transform: translateY(-2px);
      box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1);
    }
    

.role-info {
      background: #f0f9ff;
      border: 1px solid #0ea5e9;
      border-radius: 0.375rem;
      padding: 1rem;
      margin-bottom: 1.5rem;
    }

    .role-info p {
      color: #0c4a6e;
      font-size: 0.875rem;
      margin: 0;
    }
    .card {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      margin-bottom: 2rem;
    }

    .card-header {
      padding: 1.5rem;
      border-bottom: 1px solid #e5e7eb;
    }

    .card-title {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 1.25rem;
      font-weight: 600;
      color: #2563eb;
    }

    .card-content {
      padding: 1.5rem;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-group label {
      display: block;
      font-weight: 500;
      color: #374151;
      margin-bottom: 0.5rem;
    }

    .form-control {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      font-size: 1rem;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .form-control:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .form-control:disabled {
      background-color: #f3f4f6;
      cursor: not-allowed;
    }

    select.form-control option:disabled {
      color: #9ca3af;
    }


  </style>

</head>

<body>
  <!-- ======= Header ======= -->
  <header id="header" class="header d-flex align-items-center">
    <div class="container-fluid container-xl d-flex align-items-center justify-content-between">
      <a href="index.html" class="logo d-flex align-items-center">
        <img src="assets/img/Background/transparent.png" alt="Logo">
        <h1>Limpopo Varsity <br>Hackathon</h1>
      </a>

      <nav id="navbar" class="navbar">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="services.html">Rules</a></li>
          <li><a href="events.html">Events</a></li>
          <li><a href="Blog Details.html">Prizes</a></li>
          <li><a href="blog.html">Team</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="staffregi.html" class="active">Staff</a></li>
        </ul>
      </nav>
    </div>
  </header><!-- End Header -->

  <main id="main">
    <!-- Breadcrumbs -->
    <div class="breadcrumbs d-flex align-items-center" style="background-image: url('assets/img/Background/Registration.jpg');">
      <div class="container position-relative d-flex flex-column align-items-center">
        <h2>Staff Registration</h2>
        <ol>
          <li><a href="index.html">Home</a></li>
          <li>Staff Registration</li>
        </ol>
      </div>
    </div>

    <div class="container">
      <div class="form-header">
          <h2>Please provide the following:</h2>
          <p>Complete the form below to register as a staff member</p>
        </div>
      <form id="staffRegForm" onsubmit="return false" method="POST" class="row g-3 needs-validation">

        <!-- Institution -->
        <div class="form-group row">
  <label for="institution" class="col-sm-2 col-form-label">Institution</label>
  <div class="col-sm-10">
    <select class="form-control" name="institution" id="institution" required>
      <option value="" disabled selected>Select your institution</option>
      <option value="Tshwane University Of Technology">Tshwane University of Technology</option>
      <option value="University Of Limpopo">University of Limpopo</option>
      <option value="University Of Venda">University of Venda</option>
    </select>
  </div>
</div>

        <!-- Title -->
      <div class="form-group row">
  <label for="title" class="col-sm-2 col-form-label">Title</label>
  <div class="col-sm-10">
    <select class="form-control" id="title" name="title" required>
      <option value disabled selected>Select your title</option>
      <option>Dr</option>
      <option>Mr</option>
      <option>Miss</option>
      <option>Mrs</option>
    </select>
    <div class="invalid-feedback">Please select your title.</div>
  </div>
</div>

        <!-- Name and Surname -->
        <div class="form-group row">
  <label for="fullName" class="col-sm-2 col-form-label">Full Name</label>
  <div class="col-sm-10">
    <input 
      type="text" 
      class="form-control" 
      id="fullName" 
      name="fullName" 
      placeholder="Enter Name and Surname" 
      required>
  </div>
</div>

      <!-- Staff Email -->
      <div class="form-group row">
  <label for="email" class="col-sm-2 col-form-label">Staff Email</label>
  <div class="col-sm-10">
    <input 
      type="email" 
      class="form-control" 
      id="email" 
      name="email" 
      placeholder="Enter staff email address" 
      required>
  </div>
</div>


        
        <!-- If "Other" department -->
        <div class="form-group">
          <label for="other" id="otherLabel" class="col-sm-2 col-form-label" hidden>Specify</label>
          <div class="col-sm-10">
            <input type="text" class="form-control" id="other" name="other" style="display: none;">
          </div>
        </div>


<!-- HTML Role Selection -->
<div class="card">
            <div class="card-header">
              <h3 class="card-title">
                <i class="fas fa-award"></i>
                Role Selection
              </h3>
            </div>
            <div class="card-content">
              <div class="role-info">
                <p>Select main category to have access to the sub category role aligned with each main category</p>
              </div>

              <div class="form-grid">
                <div class="form-group">
                  <label for="mainCategory">Main Category</label>
                  <select class="form-control" id="mainCategory" name="mainCategory" onchange="updateSubCategories()" required>
                    <option value="">Select main category</option>
                    <option value="MEDIA,MARKETING & ENTERTAINMENT">MEDIA,MARKETING & ENTERTAINMENT</option>
                    <option value="LOGISTICS">LOGISTICS</option>
                    <option value="INDUSTRY SUPPORT">INDUSTRY SUPPORT</option>
                    <option value="REGISTRAR">REGISTRAR</option>
                    <option value="DIGITAL ACADEMY">DIGITAL ACADEMY</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="subCategory">Sub Category</label>
                  <select class="form-control" id="subCategory" name="subCategory" disabled required>
                    <option value="">Select sub category</option>
                  </select>
                </div>
              </div>
            </div>
          </div>



        <!-- Submit -->
        <div class="form-group submit-section">
  <button id="btn" onclick="registerStaff()" type="button" class="btn">SUBMIT</button>
</div>
      </form>
    </div>
  </main>

  <!-- ======= Footer ======= -->
   <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">

    <div class="footer-content position-relative">
      <div class="container">
        <div class="row">

          <div class="col-lg-4 col-md-6">
            <div class="footer-info">
              <h3>Limpopo Varsity Hackathon </h3>
              <p>109 Market street
                <br>Polokwane Ext 67<br>
                0699<br><br>
                <strong>Phone:</strong> 060 699 2594<br>
                <strong>Email:</strong> rankoana@tut.ac.za<br>
              </p>
              <div class="social-links d-flex mt-3">
                <a href="https://twitter.com/Official_TUT?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor" class="d-flex align-items-center justify-content-center"> <i class="bi bi-twitter"></i></a>
                <a href="https://www.facebook.com/TUTCommunications/" class="d-flex align-items-center justify-content-center"><i class="bi bi-facebook"></i></a>
                <a href="https://www.instagram.com/tut_official2/?hl=en" class="d-flex align-items-center justify-content-center"><i class="bi bi-instagram"></i></a>
                <a href="https://www.linkedin.com/school/tshwane-university-of-technology/mycompany/" class="d-flex align-items-center justify-content-center"><i class="bi bi-linkedin"></i></a>
              </div>
            </div>
          </div><!-- End footer info column-->

          <div class="col-lg-2 col-md-3 footer-links">
            <h4>IDE's link used</h4>
            <ul>
              <li><a href="https://code.visualstudio.com/">Visual Studio Code</a></li>
              <li><a href="https://notepad-plus-plus.org/downloads/">Note Pad++</a></li>
              <li><a href="#https://www.sublimetext.com/">Sublime Text</a></li>
              
            </ul>
          </div><!-- End footer links column-->

          <div class="col-lg-2 col-md-3 footer-links">
            <h4>Development Tools</h4>
            <ul>
              <li><a href="https://www.tutorialspoint.com/html5/index.htm">HTML5</a></li>
              <li><a href="https://www.c-sharpcorner.com/topics/ccs3">CSS3</a></li>
              <li><a href="#https://getbootstrap.com/docs/3.3/getting-started/">Bootsrap</a></li>
              <li><a href="javascript.com">Java Scripts</a></li>
              <li><a href="https://angular.io">Angular</a></li>
            </ul>
          </div><!-- End footer links column-->

          <div class="col-lg-2 col-md-3 footer-links">
            <h4>Tutorial Website(s)</h4>
            <ul>
              <li><a href="https://www.w3schools.com/">W3Schools</a></li>
              <li><a href="https://www.freecodecamp.org/news/from-zero-to-front-end-hero-part-1-7d4f7f0bff02/">Free Coode Camp</a></li>
              <li><a href="https://www.codewars.com/">CodeWars</a></li>
              <li><a href="https://www.acefrontend.com/">Ace Front End</a></li>
              <li><a href="https://javascript.plainenglish.io/10-best-websites-for-practising-and-perfecting-front-end-development-56e382b2c0ac">CSS Battles</a></li>
            </ul>
          </div><!-- End footer links column-->

          

    <div class="footer-legal text-center position-relative">
      <div class="container">
        <div class="copyright">
          &copy; Copyright <strong><span>Limpopo Varsity Hackathon </span></strong>. All Rights Reserved
        </div>
        <div class="credits">
          <!-- All the links in the footer should remain intact. -->
          <!-- You can delete the links only if you purchased the pro version. -->
          <!-- Licensing information: https://bootstrapmade.com/license/ -->
          <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/upconstruction-bootstrap-construction-website-template/ -->
         <a> Designed by TUT POLOKWANE ICEP TEAM 2022</a>
        </div>
      </div>
    </div>

  </footer>
  <!-- End Footer -->
   <script>
  // Define subcategories
  const subCategories = {
    "MEDIA,MARKETING & ENTERTAINMENT": ["Co-ordinator","Social Media", "Prizes, gifts & Guests", "Regalia"],
    "LOGISTICS": ["Co-ordinator","Venue", "Technical","Distribution & tracking"],
    "INDUSTRY SUPPORT": ["Volunteers & Sponsorship", "Adjudication", "Incubation","Co-ordinator"],
    "REGISTRAR": ["Admin", "Access control & data", "MC’s, Announcements & Presentation","Co-ordinator"],
    "DIGITAL ACADEMY": ["Workshops & webinars", "AWS Foundation","Co-ordinator"]
  };

  let takenRoles = {}; // key: mainCategory, value: array of subCategories
let isSubmitting = false; 
  // Fetch all taken roles from Firebase
  function loadTakenRoles() {
    firebase.database().ref('staff').once('value').then(snapshot => {
      takenRoles = {}; // reset

      snapshot.forEach(child => {
        const data = child.val();
        const main = data.mainCategory?.trim();
        const sub = data.subCategory?.trim();
        if (main && sub) {
          if (!takenRoles[main]) takenRoles[main] = [];
          takenRoles[main].push(sub);
        }
      });

      // Update the subcategories once loaded
      updateSubCategories();
    });
  }

  // Call it when page loads
  window.onload = loadTakenRoles;
// Update subcategories based on selected main category
    function updateSubCategories() {
      const main = document.getElementById("mainCategory").value;
      const subSelect = document.getElementById("subCategory");

      subSelect.innerHTML = '<option value="">Select sub category</option>';
      subSelect.disabled = !main;

      if (main && subCategories[main]) {
        subCategories[main].forEach(sub => {
          const option = document.createElement("option");
          option.value = sub;
          option.textContent = sub;

          if (takenRoles[main] && takenRoles[main].includes(sub)) {
            option.disabled = true;
            option.textContent += " (Taken)";
          }

          subSelect.appendChild(option);
        });
      }
    }
</script>



  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/js/main.js"></script>
  <script src="script.js"></script>
  <script>
  // Add client-side validation before calling registerStaff
  document.getElementById('btn').onclick = function(e) {
    e.preventDefault();
    const form = document.getElementById('staffRegForm');
    let valid = true;

    // Check required selects and inputs
    ['institution','staffNumber','name','surname','email','gender','department','mainCategory','subCategory'].forEach(id => {
      const el = document.getElementById(id);
      if (el && (el.value === "" || el.value === "null")) {
        el.classList.add('is-invalid');
        valid = false;
      } else if (el) {
        el.classList.remove('is-invalid');
      }
    });

    // If department is "other", check the "other" field
    const department = document.getElementById('department');
    if (department && department.value === "other") {
      const other = document.getElementById('other');
      if (!other.value.trim()) {
        other.classList.add('is-invalid');
        valid = false;
      } else {
        other.classList.remove('is-invalid');
      }
    }

    // Email format check
    const email = document.getElementById('email');
    if (email && email.value) {
      const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailPattern.test(email.value)) {
        email.classList.add('is-invalid');
        valid = false;
      } else {
        email.classList.remove('is-invalid');
      }
    }

    if (valid) {
      registerStaff();
    } else {
      swal("Please fill in all required fields correctly.", "", "error");
    }
  };
  </script>

</body>

</html>